import{ref as u,reactive as U,computed as f}from"vue";function M(h,x={}){const{defaultPageSize:d=10,defaultSortBy:P="id",defaultDescending:p=!1}=x,t=u(1),o=u(d),i=u(0),n=u(P),g=u(p),r=u(""),w=u(!1),c=u(null),v=u(null),l=U({}),T=f({get:()=>({sortBy:n.value,descending:g.value,page:t.value,rowsPerPage:o.value,rowsNumber:i.value}),set:e=>{e&&(n.value=e.sortBy||P,g.value=e.descending||!1,t.value=e.page||1,o.value=e.rowsPerPage||d)}}),y=f(()=>Math.ceil(i.value/o.value)),b=f(()=>!!c.value),m=f(()=>!!v.value),S=()=>{const e={page:t.value,page_size:o.value};if(n.value){const a=g.value?`-${n.value}`:n.value;e.ordering=a}return r.value&&(e.search=r.value),Object.keys(l).forEach(a=>{l[a]!==null&&l[a]!==void 0&&l[a]!==""&&(e[a]=l[a])}),e},s=async e=>{w.value=!0;try{let a;return e?a=await h(e):a=await h(void 0,S()),i.value=a.count,c.value=a.next,v.value=a.previous,a.results}catch(a){throw console.error("Ошибка при загрузке данных:",a),a}finally{w.value=!1}},z=async e=>(e.pagination&&(T.value=e.pagination),await s()),F=async()=>b.value&&c.value?(t.value++,await s(c.value)):[],N=async()=>m.value&&v.value?(t.value--,await s(v.value)):[],j=async()=>(t.value=1,await s()),q=async()=>(t.value=y.value,await s()),D=async e=>e>=1&&e<=y.value?(t.value=e,await s()):[],E=e=>{r.value=e,t.value=1},O=(e,a)=>{l[e]=a,t.value=1},B=()=>{Object.keys(l).forEach(e=>{delete l[e]}),r.value="",t.value=1};return{currentPage:t,pageSize:o,totalCount:i,sortBy:n,descending:g,searchQuery:r,loading:w,nextPageUrl:c,prevPageUrl:v,filters:l,qTablePagination:T,totalPages:y,hasNext:b,hasPrevious:m,fetchData:s,handleTableRequest:z,goToNextPage:F,goToPreviousPage:N,goToFirstPage:j,goToLastPage:q,goToPage:D,setSearch:E,setFilter:O,clearFilters:B,reset:()=>{t.value=1,o.value=d,n.value=P,g.value=p,r.value="",i.value=0,c.value=null,v.value=null,B()}}}export{M as u};
